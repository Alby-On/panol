<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Historial de Solicitudes Entregadas</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background: #f4f6f8;
    }
    h2 {
      color: #333;
    }
    .solicitud {
      background: #fff;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .solicitud h3 {
      margin: 0;
      color: #0077cc;
    }
    .material {
      margin-left: 20px;
    }
    .loading {
      color: #666;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h2>Historial de Solicitudes Entregadas</h2>
  <div id="contenedor">
    <p class="loading">Cargando historial...</p>
  </div>

  <script>
    function cargarHistorial() {
      google.script.run.withSuccessHandler(mostrarHistorial).obtenerHistorialEntregado();
    }

    function mostrarHistorial(historial) {
      const cont = document.getElementById("contenedor");
      cont.innerHTML = "";

      if (historial.length === 0) {
        cont.innerHTML = "<p>No hay solicitudes entregadas.</p>";
        return;
      }

      historial.forEach(s => {
        const div = document.createElement("div");
        div.className = "solicitud";
        div.innerHTML = `
          <h3>Solicitud ID: ${s.id}</h3>
          <p><strong>Fecha:</strong> ${s.fecha}</p>
          <p><strong>Usuario:</strong> ${s.usuario}</p>
          <p><strong>Tipo Usuario:</strong> ${s.tipo}</p>
          <p><strong>Estado:</strong> ${s.estado}</p>
          <p><strong>Materiales Solicitados:</strong></p>
          <ul class="material">
            ${s.materiales.map(m => `<li>${m.nombre} â€” ${m.cantidad}</li>`).join("")}
          </ul>
        `;
        cont.appendChild(div);
      });
    }

    window.onload = cargarHistorial;
  </script>
</body>
</html>

