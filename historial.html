<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Historial de Solicitudes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; background: #f0f2f5; margin:0; padding:20px; }
.box { background:white; max-width:500px; margin:auto; padding:20px; border-radius:12px; box-shadow:0 0 12px rgba(0,0,0,0.15);}
h2{text-align:center;}
.solicitud {background:#fff; padding:12px; border-radius:10px; margin-bottom:12px; border:1px solid #ddd;}
.btn {width:100%; padding:10px; margin-top:8px; border:none; border-radius:6px; font-size:16px; cursor:pointer;}
.btnDetalle {background:#17a2b8; color:white;}
.btnVolver {background:#6c757d; color:white; margin-top:15px;}
</style>
</head>
<body>

<div class="box">
<h2>Historial de Solicitudes</h2>
<div id="listado">Cargando historial...</div>
<button class="btnVolver" onclick="location.href='menu.html'">Volver</button>
</div>

<script>
const API_URL = "TU_URL_DEL_SCRIPT_AQUI"; // Reemplaza con tu URL

const user = JSON.parse(localStorage.getItem("currentUser"));
if(!user) location.href="index.html";

async function cargarHistorial(){
    const cont = document.getElementById("listado");
    try{
        const res = await fetch(API_URL,{
            method:"POST",
            body: JSON.stringify({ action:"getHistorial", userEmail:user.email })
        });
        const json = await res.json();
        if(!json.ok){ cont.innerHTML="Error al cargar historial."; return; }
        if(json.solicitudes.length===0){ cont.innerHTML="<p>No tienes solicitudes registradas.</p>"; return; }

        cont.innerHTML="";
        json.solicitudes.forEach(sol=>{
            const div = document.createElement("div");
            div.className="solicitud";
            div.innerHTML=`
                <b>ID:</b> ${sol.id}<br>
                <b>Docente:</b> ${sol.docente}<br>
                <b>Asignatura:</b> ${sol.asignatura}<br>
                <b>Fecha:</b> ${sol.fecha}<br>
                <b>Estado:</b> ${sol.estado}<br>
                <button class="btn btnDetalle" onclick="alert('Ver materiales en próxima versión')">Ver materiales</button>
            `;
            cont.appendChild(div);
        });
    }catch(err){
        cont.innerHTML="Error de conexión.";
    }
}

cargarHistorial();
</script>

</body>
</html>

